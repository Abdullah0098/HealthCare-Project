version: 2

metrics:
  - name: average_unit_price
    model: ref('sales')
    label: average amount unit price
    description: "The average amount of unit price"

    calculation_method: average
    expression: Sale_amt

    timestamp: orderdate
    time_grains: [day, week, month, quarter, year, all_time]
    dimensions:
      - Region
      - item
      - SalesMan

    filters:
    - field: Unit_price #column name
      operator: '>=' # operation we want to perform
      value: "500" # conditional value to which against the filteration is performed
    - field: Units
      operator: '>='
      value: '50'

  # general properties
    config:
        enabled: true # after enabling the metric config, then it will consider it as a part of the dbt project
        treat_null_values_as_zero: true # the null values are replaced with 0